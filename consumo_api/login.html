<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        main {
            margin: auto;
            width: 250px;
        }

        main * {
            width: 100%;
        }

        #erro {
            display: none;
            color: red;
        }

    </style>
    <title>Login</title>
</head>
<body>
    <main>
        <hr>
        <h1>Login</h1>
        <input type="email" id="email" placeholder="email">
        <input type="password" id="password" placeholder="senha">
        <button type="button" onclick="logar()">Login</button>
        <small id="erro"></small>
    </main>
</body>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>

    // http://localhost:8080/game
    const link = 'http://localhost:8080';

    document.addEventListener('keypress', (event) => {
        if (event.key == 'Enter') {
            logar();
        }
    })

    async function logar() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        
        try {
            const response = await axios.post(link + '/auth', { email, password });
            localStorage.setItem("token", `${response.data.token}`)
            location.replace('/consumo_api');

        } catch (error) {
            const smallError = document.getElementById('erro');
            smallError.style.display = 'block'
            smallError.innerHTML = error.response.data.err
            console.log(error);
        }
    }
</script>

</html>